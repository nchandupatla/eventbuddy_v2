{"version":3,"sources":["../../src/pages/send-push/send-push.module.ts","../../src/pages/send-push/send-push.ts","../../src/pipes/pipes.module.ts","../../src/pipes/users.ts"],"names":[],"mappings":"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","file":"0.main.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { SendPushPage } from './send-push';\r\nimport { PipesModule } from './../../pipes/pipes.module';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    SendPushPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(SendPushPage),\r\n    TranslateModule.forChild(),\r\n    PipesModule\r\n  ],\r\n  exports: [\r\n    SendPushPage\r\n  ]\r\n})\r\nexport class SendPushPageModule { }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/send-push/send-push.module.ts","import { Component } from '@angular/core';\r\nimport { Platform, IonicPage, NavController } from 'ionic-angular';\r\nimport { AlertProvider, AuthProvider, DatabaseProvider, NetworkProvider, NotificationProvider, LoadingProvider, ToastProvider, TranslateProvider, UsersApi } from '../../providers';\r\nimport * as firebase from 'firebase';\r\nimport { User } from '../../models/user';\r\nimport { ToastConfig } from '../../configs/toast-config';\r\nimport { Subscription } from 'rxjs/Subscription';\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-send-push',\r\n  templateUrl: 'send-push.html'\r\n})\r\nexport class SendPushPage {\r\n  private usersLoaded: boolean;\r\n  private users: User[];\r\n  private user: User;\r\n  private usersSubscription: Subscription;\r\n  private userSubscription: Subscription;\r\n  private excludedIds: string[];\r\n\r\n  private imageLoadedMap: Map<string, boolean>;\r\n  constructor(private platform: Platform,\r\n    public navCtrl: NavController,\r\n    private alert: AlertProvider,\r\n    private auth: AuthProvider,\r\n    private network: NetworkProvider,\r\n    private notification: NotificationProvider,\r\n    private loading: LoadingProvider,\r\n    private toast: ToastProvider,\r\n    private translate: TranslateProvider,\r\n    private usersApi: UsersApi) {\r\n    this.imageLoadedMap = new Map<string, boolean>();\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    this.auth.getUser().then((user: firebase.User) => {\r\n      //Subscribe to changes made to users list.\r\n      this.usersSubscription = this.usersApi.usersSubscription.subscribe((users: User[]) => {\r\n        this.users = users;\r\n        //Set excludedIds so the current user will not show up on the list.\r\n        this.setExcludedIds();\r\n      });\r\n\r\n      //Subscribe to changes made to the user.\r\n      this.userSubscription = this.usersApi.subscriptions.get(user.uid).subscribe((user: User) => {\r\n        this.user = user;\r\n      });\r\n\r\n      this.users = this.usersApi.getUsers();\r\n      this.user = this.usersApi.getCurrentUser();\r\n      this.setExcludedIds();\r\n    });\r\n  }\r\n\r\n  //Exclude current user from the list.\r\n  private setExcludedIds(): void {\r\n    if (this.user)\r\n      this.excludedIds = [this.user.userId];\r\n  }\r\n\r\n  ionViewWillLeave() {\r\n    if (this.usersSubscription)\r\n      this.usersSubscription.unsubscribe();\r\n    if (this.userSubscription)\r\n      this.userSubscription.unsubscribe();\r\n  }\r\n\r\n  private sendPushNotification(deviceToken: string): void {\r\n    this.loading.show();\r\n    let title = 'Jetpush';\r\n    let message = this.user.firstName + ' ' + this.user.lastName + ' ' + this.translate.get('HAS_SENT_PUSH_NOTIFICATION') + '.';\r\n    this.notification.sendPushNotification(deviceToken, title, message).then(() => {\r\n      this.loading.hide();\r\n      this.toast.showWithDuration(this.translate.get('PUSH_NOTIFICATION_SENT'), ToastConfig.duration);\r\n    }).catch((error) => {\r\n      this.loading.hide();\r\n      this.toast.showWithDuration(this.translate.get('PUSH_NOTIFICATION_ERROR'), ToastConfig.duration);\r\n      console.error(\"Error: \" + JSON.stringify(error));\r\n    });\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/send-push/send-push.ts","import { NgModule } from '@angular/core';\r\nimport { UsersPipe } from './users';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    UsersPipe,\r\n  ],\r\n  imports: [\r\n\r\n  ],\r\n  exports: [\r\n    UsersPipe,\r\n  ]\r\n})\r\nexport class PipesModule { }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pipes/pipes.module.ts","import { Injectable, Pipe, PipeTransform } from '@angular/core';\r\nimport { User } from '../models/user';\r\n\r\n@Pipe({\r\n  name: 'usersFilter',\r\n  pure: false\r\n})\r\n@Injectable()\r\nexport class UsersPipe implements PipeTransform {\r\n  transform(users: User[], excludedIds: string[]): any {\r\n    if (!users) {\r\n      return;\r\n    } else if (!excludedIds) {\r\n      return users;\r\n    } else if (excludedIds) {\r\n      return users.filter((user: User) => excludedIds.indexOf(user.userId) == -1);\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pipes/users.ts"],"sourceRoot":""}