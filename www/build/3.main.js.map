{"version":3,"sources":["../../src/pages/update-profile/update-profile.module.ts","../../src/pages/update-profile/update-profile.ts"],"names":[],"mappings":"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","file":"3.main.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { UpdateProfilePage } from './update-profile';\n\n@NgModule({\n  declarations: [\n    UpdateProfilePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(UpdateProfilePage),\n    TranslateModule.forChild()\n  ],\n  exports: [\n    UpdateProfilePage\n  ]\n})\nexport class UpdateProfilePageModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/update-profile/update-profile.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ActionSheetController } from 'ionic-angular';\nimport { AuthProvider, NetworkProvider, DatabaseProvider, LoadingProvider, StorageProvider, AlertProvider, TranslateProvider, UsersApi } from '../../providers';\nimport { User } from '../../models/user';\nimport * as firebase from 'firebase';\nimport { FormBuilder, FormGroup, Validators, ValidatorFn } from '@angular/forms';\nimport { Keyboard } from '@ionic-native/keyboard';\nimport { Camera } from '@ionic-native/camera';\nimport { Subscription } from 'rxjs/Subscription';\n\n@IonicPage()\n@Component({\n  selector: 'page-update-profile',\n  templateUrl: 'update-profile.html',\n})\nexport class UpdateProfilePage {\n  private user: User;\n  private subscription: Subscription;\n  private profileForm: FormGroup;\n  private nameValidator: ValidatorFn = Validators.compose([\n    Validators.required\n  ]);\n  private emailValidator: ValidatorFn = Validators.compose([\n    Validators.required,\n    Validators.email\n  ]);\n  private phoneValidator: ValidatorFn = Validators.compose([\n    Validators.required,\n  ]);\n  private profilePic: string;\n  private loaded: boolean;\n\n  private defaultImg: string = 'assets/images/profile.png';\n  constructor(public navCtrl: NavController,\n    public navParams: NavParams,\n    private auth: AuthProvider,\n    private network: NetworkProvider,\n    private database: DatabaseProvider,\n    private loading: LoadingProvider,\n    private storage: StorageProvider,\n    private alert: AlertProvider,\n    private translate: TranslateProvider,\n    private usersApi: UsersApi,\n    private formBuilder: FormBuilder,\n    private keyboard: Keyboard,\n    private camera: Camera,\n    private actionSheetCtrl: ActionSheetController) {\n    this.profileForm = this.formBuilder.group({\n      firstName: ['', this.nameValidator],\n      lastName: ['', this.nameValidator],\n      email: ['', this.emailValidator],\n      phone:['', this.phoneValidator]\n    });\n    this.profileForm.get('email').disable();\n  }\n\n  ionViewDidLoad() {\n    this.auth.getUser().then((user: firebase.User) => {\n      if (!this.subscription) {\n        //Subscribe to changes made to the user.\n        this.subscription = this.usersApi.subscriptions.get(user.uid).subscribe((user: User) => {\n          this.user = user;\n          this.profilePic = user.profilePic;\n          //Set values to form.\n          this.profileForm.setValue({\n            firstName: this.user.firstName,\n            lastName: this.user.lastName,\n            email: this.user.email,\n            phone:this.user.phone\n          });\n        });\n      }\n\n      this.user = this.usersApi.getCurrentUser();\n      this.profilePic = this.user.profilePic;\n      //Set values to form.\n      this.profileForm.setValue({\n        firstName: this.user.firstName,\n        lastName: this.user.lastName,\n        email: this.user.email,\n       phone:this.user.phone\n      });\n    });\n  }\n\n  ionViewWillLeave() {\n    if (this.subscription)\n      this.subscription.unsubscribe();\n  }\n\n  keyDownFunction(event) {\n    if (event.keyCode == 13) {\n      this.keyboard.close();\n      if (this.profileForm.valid)\n        this.updateProfile();\n    }\n  }\n\n  private back(): void {\n    if (this.user.profilePic != this.defaultImg && this.profilePic == this.defaultImg) {\n      this.storage.deleteProfilePic(this.user.userId, this.user.profilePic).then(() => {\n        this.user.profilePic = this.defaultImg;\n      });\n    } else if (this.user.profilePic == this.defaultImg && this.profilePic != this.defaultImg) {\n      this.user.profilePic = this.profilePic;\n    }\n    this.navCtrl.pop();\n  }\n\n  private updateProfile(): void {\n    this.loading.show();\n    this.user.firstName = this.profileForm.value['firstName'];\n    this.user.lastName = this.profileForm.value['lastName'];\n    this.database.setUser(this.user).then(() => {\n      this.loading.hide();\n      this.profilePic = this.user.profilePic;\n      this.alert.showAlert(this.translate.get('PROFILE_UPDATED'), this.translate.get('PROFILE_UPDATED_MESSAGE'), this.translate.get('OK')).then(() => { });\n    }).catch((error) => {\n    });\n  }\n\n  private setProfilePic(): void {\n    this.actionSheetCtrl.create({\n      title: this.translate.get('SET_PROFILE_PICTURE'),\n      buttons: [\n        {\n          text: this.translate.get('TAKE_A_PHOTO'),\n          role: 'destructive',\n          handler: () => {\n            this.storage.uploadProfilePic(this.user.userId, this.camera.PictureSourceType.CAMERA).then(profilePic => {\n              if (this.user.profilePic != this.profilePic) {\n                this.storage.deleteProfilePic(this.user.userId, this.user.profilePic).then(() => {\n                  this.user.profilePic = profilePic;\n                });\n              } else {\n                this.user.profilePic = profilePic;\n              }\n            });\n          }\n        },\n        {\n          text: this.translate.get('CHOOSE_FROM_GALLERY'),\n          handler: () => {\n            this.storage.uploadProfilePic(this.user.userId, this.camera.PictureSourceType.PHOTOLIBRARY).then(profilePic => {\n              if (this.user.profilePic != this.profilePic) {\n                this.storage.deleteProfilePic(this.user.userId, this.user.profilePic).then(() => {\n                  this.user.profilePic = profilePic;\n                });\n              } else {\n                this.user.profilePic = profilePic;\n              }\n            });\n          }\n        },\n        {\n          text: this.translate.get('CANCEL'),\n          role: 'cancel',\n          handler: () => {\n          }\n        }\n      ]\n    }).present();\n  }\n\n  private removeProfilePic(): void {\n    if (this.profilePic == this.defaultImg) {\n      this.storage.deleteProfilePic(this.user.userId, this.user.profilePic).then(() => {\n        this.user.profilePic = this.profilePic;\n      });\n    } else {\n      this.user.profilePic = this.defaultImg;\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/update-profile/update-profile.ts"],"sourceRoot":""}